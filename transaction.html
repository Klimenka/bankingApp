<!DOCTYPE htlm>
<html>
    <head>
        <title>Banking API</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <link rel="shortcut icon" href="css/hydra.ico" type="image/x-icon"/>
        <link href="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css" integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb" crossorigin="anonymous">           
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css">
        <link rel="stylesheet" href="css/header3.css">
        <script src="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
        <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>           
        <script defer src="https://use.fontawesome.com/releases/v5.0.1/js/all.js"></script>  
    </head>

    <style>
        th, td, p, input {
            font:14px Verdana;
        }
        table, th, td 
        {
            border: solid 1px #DDD;
            border-collapse: collapse;
            padding: 2px 3px;
            text-align: center;
        }
        th {
            font-weight:bold;
        }
    </style>

    <script src='//unpkg.com/swagger-client' type='text/javascript'></script>
    <script type='text/javascript' src='js/transactionFunctions.js'></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>

    <script type="text/javascript">
        async function CreateTable(transactionInformation)
        {          
            if(transactionInformation.length >= 0)
            {
                var table = document.createElement("table");
                table.style.width = '500px';
                table.style.height = 'auto';
                table.setAttribute('border', '1');
                table.setAttribute('cellspacing', '0');
                table.setAttribute('cellpadding', '5');
             
                var col = []; 
                for (var i = 0; i < transactionInformation.length; i++) {
                    for (var key in transactionInformation[i]) {
                        if (col.indexOf(key) === -1){
                            col.push(key);
                        }
                    }
                }
                        
                var tHead = document.createElement("thead");	                
                var hRow = document.createElement("tr");
                        
                for (var i = 0; i < col.length; i++){
                    var th = document.createElement("th");
                    th.innerHTML = col[i];
                    hRow.appendChild(th);
                }

                tHead.appendChild(hRow);
                table.appendChild(tHead);
                        
                var tBody = document.createElement("tbody");	
                        
                for (var i = 0; i < transactionInformation.length; i++) {
                    var bRow = document.createElement("tr"); 
                                                       
                    for (var j = 0; j < col.length; j++) {
                        var td = document.createElement("td");
                            if(typeof transactionInformation[i][col[j]]==="object"){
                                td.innerHTML = JSON.stringify(transactionInformation[i][col[j]])
                            }
                            else{
                                td.innerHTML = transactionInformation[i][col[j]];
                            }
                        bRow.appendChild(td);
                    }
                    tBody.appendChild(bRow)  
                }
                table.appendChild(tBody);	
                
                var divContainer = document.getElementById("Transactions");
                divContainer.innerHTML = "";
                divContainer.appendChild(table);
            }	
        }

        async function RetrieveAllTransactions(){
            var transactionInformation = await getTransactionsByAccountName('NL49INHO0000000003');
            CreateTable(transactionInformation);            
        }

        async function RetrieveOneTransaction(id){
            var transactionInformation = await getTransactionById(id);
            CreateTable(transactionInformation);            
        }
    </script>

    <body onload="RetrieveAllTransactions()">

            <header class="header" id="header1">
                <div class="center">
                    <div class="caption animated bounceInDown">
                        <h2 class="title display-3">Transaction</h2>
                        <p class="text">Where transactions happen</p>
                        <button class="action btn btn-Light" onclick="location.href = 'index.php'"> Home </button>
                        <button class="action btn btn-Light" onclick="location.href = 'performTransaction.html'">Perform transaction</button>
                        <button class="action btn btn-Light" onclick="location.href = 'performWithdraw.html'">Perform withdraw</button>
                        <button class="action btn btn-Light" onclick="location.href = 'performDeposit.html'">Perform deposit</button>
                    </div>	
                </div>
            </header>

        <button onclick="RetrieveAllTransactions()" style="font-size: 20px; margin-top:5px; margin-left: 20px;"> Retrieve All Transactions</button>
            
        <input id=transactionId type="number" style="margin-left: 1270px; font-size: 20px;" name='transactionId' min=1>
        <button style="font-size: 20px;" onclick="RetrieveOneTransaction('transactionId')">Retrieve one transaction</button>

        <div id="Transactions" style="width:100%; margin-top: 20px;"></div>

        <div class="footer-more d-lg-flex justify-content-around"></div>
        
    </body>
</html>
